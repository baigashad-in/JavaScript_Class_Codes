<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="Bootstrap_files/CSS/bootstrap.css">
</head>

<body>
    <table class="table">
        <thead class="table-danger">
            <th>Sr.No.</th>
            <th><input type="text" placeholder="Search" onkeyup="filterColumns(this, 'id')"> <br> Id </th>
            <th><input type="text" placeholder="Search" onkeyup="filterColumns(this, 'title')"> <br> Title </th>
            <th><input type="text" placeholder="Search" onkeyup="filterColumns(this, 'medium_display')"> <br> Medium of Display </th>
            <th><input type="text" placeholder="Search" onkeyup="filterColumns(this, 'department_title')"> <br> Department </th>
            <th>Image</th>
        </thead>
        <tbody class="table-secondary">

        </tbody>
    </table>
    <script>
        const getArtWorks = async ()=> {
            let artWorkArr = []
            let configImageArr = {}
            const url = "https://api.artic.edu/api/v1/artworks"
            const responseVariable = await fetch(url)
            let data = await responseVariable.json()
            console.log(data)
            artWorkArr = data.data
            configImageArr = data.config
            console.log("data = ",artWorkArr)
            console.log("config = ",configImageArr)
            artWorkArr.push(configImageArr)
            console.log("new data = ",artWorkArr)

            let rows = ""
            artWorkArr.slice(0,artWorkArr.length-1).forEach((element,index) => {
                if (element.image_id != null) {
                    rows = rows + `<tr><th>${index + 1}</th><td>${element.id}</td><td>${element.title}</td><td>${element.medium_display}</td><td>${element.department_title	}</td><td><img height = "80px" width = "80px" src="${"https://www.artic.edu/iiif/2/" + element.image_id + "/full/843,/0/default.jpg"}"></td></tr>`
                }
                
            });
            document.querySelector("tbody").innerHTML = rows
            return artWorkArr
        }
        getArtWorks()

        const filterColumns = async (argFromInput, columnName) => {

            var arrForFiltering = await getArtWorks()
            // console.log("New Array = ",arrForFiltering)

            var filterVal = argFromInput.value.toLowerCase()
            var filterOutput = arrForFiltering.filter((element, index, array) => {
                if (element[columnName] != undefined) 
                    {
                        return element[columnName].toString().toLowerCase().includes(filterVal) // returns true or false
                    }
            })

            let res =""
            filterOutput.forEach((item, index, array) => {
                 res = res + `<tr><th>${index + 1}</th><td>${item.id}</td><td>${item.title}</td><td>${item.medium_display}</td><td>${item.department_title	}</td><td><img height = "80px" width = "80px" src="${"https://www.artic.edu/iiif/2/" + item.image_id + "/full/843,/0/default.jpg"}"></td></tr>`
            })
            document.querySelector("tbody").innerHTML = res
        }


    </script>
</body>
</html>